# MikroKredit - –û—Ç—á—ë—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
**–î–∞—Ç–∞:** 09.10.2025 08:32 MSK

## ‚úÖ –°—Ç–∞—Ç—É—Å: –†–ê–ë–û–¢–ê–ï–¢

### –°–µ—Ä–≤–∏—Å—ã
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|--------|
| PostgreSQL | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | localhost:5432, –ë–î: mikrokredit |
| Gunicorn | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 4 –≤–æ—Ä–∫–µ—Ä–∞, –ø–æ—Ä—Ç 8002 |
| Nginx | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–æ—Ä—Ç 80, reverse proxy |
| –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | HTTP 200, 10/10 —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ |

### –î–∞–Ω–Ω—ã–µ
- **–í—Å–µ–≥–æ –∑–∞–π–º–æ–≤:** 26
- **–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö:** 17
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL 17
- **–†–∞–∑–º–µ—Ä –ë–î:** ~175MB

### –ü—Ä–æ—Ü–µ—Å—Å—ã
```
PID    | –†–æ–ª—å          | –ü–∞–º—è—Ç—å
-------|---------------|--------
73520  | Master        | 68.2 MB
73523  | Worker 1      | 54.2 MB
73524  | Worker 2      | 54.1 MB
73525  | Worker 3      | 57.6 MB
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `/home/valstan/mikrokredit`
- **–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:** `.venv/`
- **Python:** 3.12
- **Gunicorn:** 21.2.0
- **SQLAlchemy:** —Å –ø—É–ª–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (10+20)

### –õ–æ–≥–∏
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** `/home/valstan/mikrokredit/logs/`
  - `access.log` - –ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–∞
  - `error.log` - –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
- **Nginx:** `/var/log/nginx/`
  - `mikrokredit_access.log`
  - `mikrokredit_error.log`

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

#### –ó–∞–ø—É—Å–∫:
```bash
cd /home/valstan/mikrokredit
./start_service.sh
```

#### –û—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
cd /home/valstan/mikrokredit
./stop_service.sh
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# Health check
curl http://127.0.0.1:8002/healthz

# –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
curl -I http://localhost/

# –ü—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep gunicorn | grep mikrokredit

# –õ–æ–≥–∏ (—Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
tail -f logs/error.log
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. ‚úÖ SSL SYSCALL error: EOF detected (–¥–æ–±–∞–≤–ª–µ–Ω pool_pre_ping)
2. ‚úÖ –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –ë–î (mikrokredit_pass ‚Üí mikrokredit_pass_2024)
3. ‚úÖ –ù–µ–≤–µ—Ä–Ω—ã–µ –ø—É—Ç–∏ (/development/mikrokredit ‚Üí /mikrokredit)
4. ‚úÖ –ù–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç –ë–î (5434 ‚Üí 5432)
5. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQLite –≤–º–µ—Å—Ç–æ PostgreSQL (–æ—Ç–∫–ª—é—á–µ–Ω–æ)
6. ‚úÖ Internal Server Error 500 ‚Üí 200 OK

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –¢–µ—Å—Ç 1: 10 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
Result: 200 200 200 200 200 200 200 200 200 200 ‚úÖ

# –¢–µ—Å—Ç 2: Health check
Result: {"status":"ok"} ‚úÖ

# –¢–µ—Å—Ç 3: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
Result: <title>MikroKredit Web</title> ‚úÖ

# –¢–µ—Å—Ç 4: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
Result: 26 loans found ‚úÖ
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—É–ª–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:
- **pool_size:** 10
- **max_overflow:** 20
- **pool_pre_ping:** true (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º)
- **pool_recycle:** 3600s (1 —á–∞—Å)

### Gunicorn:
- **workers:** 3
- **timeout:** 30s
- **max_requests:** 1000
- **max_requests_jitter:** 50

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Headers (Nginx):
- ‚úÖ X-Frame-Options: SAMEORIGIN
- ‚úÖ X-XSS-Protection: 1; mode=block
- ‚úÖ X-Content-Type-Options: nosniff
- ‚úÖ Referrer-Policy: no-referrer-when-downgrade
- ‚úÖ Content-Security-Policy

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ Dedicated user (mikrokredit_user)
- ‚úÖ Strong password
- ‚úÖ Local connection only (localhost)

## üìù TODO (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –î–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ:
```bash
# –¢—Ä–µ–±—É–µ—Ç sudo:
sudo cp mikrokredit.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable mikrokredit
sudo systemctl start mikrokredit
```

### –£–ª—É—á—à–µ–Ω–∏—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é):
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus/Grafana)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤ (logrotate)
- [ ] –î–æ–±–∞–≤–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è Nginx
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall rules

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **FIXES_2025-10-09.md** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- **DEPLOYMENT.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é
- **README.md** - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ

---
**–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 09.10.2025 08:32 MSK
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

