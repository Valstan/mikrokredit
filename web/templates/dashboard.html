{% extends "base.html" %}

{% block title %}Dashboard - MikroKredit Manager{% endblock %}

{% block content %}

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div class="row mb-4">
    <div class="col-md-6">
        <a href="{{ url_for('views.loan_new_v2') }}" class="btn btn-primary w-100 py-3">
            üí≥ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–π–º
        </a>
    </div>
    <div class="col-md-6">
        <a href="{{ url_for('tasks.new') }}" class="btn btn-success w-100 py-3">
            ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É
        </a>
    </div>
</div>

<!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
<div class="row mb-4">
    <!-- –ú–∏–∫—Ä–æ–ö—Ä–µ–¥–∏—Ç -->
    <div class="col-md-6 mb-3">
        <div class="card h-100 border-primary">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">üí≥ –ú–∏–∫—Ä–æ–ö—Ä–µ–¥–∏—Ç</h5>
            </div>
            <div class="card-body">
                <div class="row text-center mb-3">
                    <div class="col-4">
                        <h3 class="mb-0">{{ loans_stats.total }}</h3>
                        <small class="text-muted">–í—Å–µ–≥–æ</small>
                    </div>
                    <div class="col-4">
                        <h3 class="mb-0 text-warning">{{ loans_stats.urgent_count }}</h3>
                        <small class="text-muted">–ì–æ—Ä—è—â–∏–µ</small>
                    </div>
                    <div class="col-4">
                        <h3 class="mb-0 text-danger">{{ "%.0f"|format(loans_stats.total_debt) }}</h3>
                        <small class="text-muted">‚ÇΩ –¥–æ–ª–≥</small>
                    </div>
                </div>
                
                {% if urgent_loans %}
                <div class="alert alert-warning mb-0">
                    <strong>üî• –ì–æ—Ä—è—â–∏–µ –∑–∞–π–º—ã:</strong> {{ urgent_loans|length }}
                    <ul class="mb-0 mt-2 small">
                        {% for loan in urgent_loans[:5] %}
                        <li>
                            <strong>{{ loan.org_name }}</strong>
                            {% if loan.days_left < 0 %}
                                <span class="badge bg-danger">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω {{ -loan.days_left }} –¥–Ω.</span>
                            {% elif loan.days_left == 0 %}
                                <span class="badge bg-danger">–°–µ–≥–æ–¥–Ω—è</span>
                            {% elif loan.days_left == 1 %}
                                <span class="badge bg-warning">–ó–∞–≤—Ç—Ä–∞</span>
                            {% else %}
                                <span class="badge bg-warning">{{ loan.days_left }} –¥–Ω.</span>
                            {% endif %}
                            - {{ "%.0f"|format(loan.amount_due) }} ‚ÇΩ
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                
                <div class="mt-3">
                    <a href="{{ url_for('views.loans_index') }}" class="btn btn-outline-primary w-100">
                        –ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–π–º–∞–º ‚Üí
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –û—Ä–≥–∞–Ω–∞–π–∑–µ—Ä –∑–∞–¥–∞—á -->
    <div class="col-md-6 mb-3">
        <div class="card h-100 border-success">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">‚úÖ –û—Ä–≥–∞–Ω–∞–π–∑–µ—Ä –∑–∞–¥–∞—á</h5>
            </div>
            <div class="card-body">
                <div class="row text-center mb-3">
                    <div class="col-3">
                        <h3 class="mb-0">{{ tasks_stats.total }}</h3>
                        <small class="text-muted">–í—Å–µ–≥–æ</small>
                    </div>
                    <div class="col-3">
                        <h3 class="mb-0 text-primary">{{ tasks_stats.pending }}</h3>
                        <small class="text-muted">–ê–∫—Ç–∏–≤–Ω—ã—Ö</small>
                    </div>
                    <div class="col-3">
                        <h3 class="mb-0 text-warning">{{ tasks_stats.today }}</h3>
                        <small class="text-muted">–°–µ–≥–æ–¥–Ω—è</small>
                    </div>
                    <div class="col-3">
                        <h3 class="mb-0 text-danger">{{ tasks_stats.overdue }}</h3>
                        <small class="text-muted">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</small>
                    </div>
                </div>
                
                {% if today_tasks %}
                <div class="alert alert-info mb-0">
                    <strong>üìÖ –ó–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</strong>
                    <ul class="mb-0 mt-2">
                        {% for task in today_tasks %}
                        <li>
                            {% if task.importance == 1 %}
                                <span class="badge bg-danger">–í–∞–∂–Ω–∞—è</span>
                            {% elif task.importance == 2 %}
                                <span class="badge bg-warning">–ù—É–∂–Ω–∞—è</span>
                            {% else %}
                                <span class="badge bg-secondary">–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ</span>
                            {% endif %}
                            {{ task.title }}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                
                <div class="mt-3">
                    <a href="{{ url_for('tasks.index') }}" class="btn btn-outline-success w-100">
                        –ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–¥–∞—á–∞–º ‚Üí
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –†–∞–∑–¥–µ–ª—ã —Å–∏—Å—Ç–µ–º—ã -->
<div class="row">
    <div class="col-12">
        <h4 class="mb-3">üóÇÔ∏è –†–∞–∑–¥–µ–ª—ã —Å–∏—Å—Ç–µ–º—ã</h4>
    </div>
    
    <div class="col-md-4 mb-3">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">üí≥ –ú–∏–∫—Ä–æ–ö—Ä–µ–¥–∏—Ç</h5>
                <p class="card-text">–£—á—ë—Ç –º–∏–∫—Ä–æ–∑–∞–π–º–æ–≤, –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Ä–∞—Å—Å—Ä–æ—á–∫–µ, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö</p>
                <ul class="small text-muted">
                    <li>–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–π–º–æ–≤</li>
                    <li>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–ª–∞—Ç–µ–∂–µ–π</li>
                    <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</li>
                    <li>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
                </ul>
                <a href="{{ url_for('views.loans_index') }}" class="btn btn-primary btn-sm">–û—Ç–∫—Ä—ã—Ç—å ‚Üí</a>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-3">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">‚úÖ –û—Ä–≥–∞–Ω–∞–π–∑–µ—Ä –∑–∞–¥–∞—á</h5>
                <p class="card-text">–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–ª, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ Telegram, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</p>
                <ul class="small text-muted">
                    <li>–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á —Å –¥–µ–¥–ª–∞–π–Ω–∞–º–∏</li>
                    <li>–ü–æ–¥–∑–∞–¥–∞—á–∏ (—á–µ–∫–ª–∏—Å—Ç—ã)</li>
                    <li>–®–∞–±–ª–æ–Ω—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</li>
                    <li>Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
                </ul>
                <a href="{{ url_for('tasks.index') }}" class="btn btn-success btn-sm">–û—Ç–∫—Ä—ã—Ç—å ‚Üí</a>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-3">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
                <p class="card-text">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∑–∞–π–º–∞–º –∏ –∑–∞–¥–∞—á–∞–º, –≥—Ä–∞—Ñ–∏–∫–∏, –æ—Ç—á—ë—Ç—ã</p>
                <ul class="small text-muted">
                    <li>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø–æ –¥–Ω—è–º</li>
                    <li>–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π</li>
                    <li>–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</li>
                    <li>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</li>
                </ul>
                <a href="#" class="btn btn-info btn-sm disabled">–°–∫–æ—Ä–æ ‚Üí</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

