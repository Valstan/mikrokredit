# –£–¥–∞–ª–µ–Ω–∏–µ Docker –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ - 09.10.2025

## –ü—Ä–∏—á–∏–Ω–∞

Docker –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ MikroKredit. –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ:
- PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å–∏—Å—Ç–µ–º–Ω–æ
- Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å–∏—Å—Ç–µ–º–Ω–æ
- Redis —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å–∏—Å—Ç–µ–º–Ω–æ
- Python —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ virtualenv
- Gunicorn –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é

–î–ª—è –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –æ–¥–Ω–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã.

## –ß—Ç–æ –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:
```
docker-ce                    (5:28.5.1)
docker-ce-cli               (5:28.5.1)
docker-ce-rootless-extras   (5:28.5.1)
docker-buildx-plugin        (0.29.1)
docker-compose-plugin       (2.40.0)
containerd.io               (1.7.28)
libslirp0                   (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)
pigz                        (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)
slirp4netns                 (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)
```

### –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```
/var/lib/docker/            (Docker –¥–∞–Ω–Ω—ã–µ)
/etc/docker/                (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
~/.docker/                  (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
/etc/apt/sources.list.d/docker.list  (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)
```

### –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞:
```
Dockerfile                  (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞)
docker-compose.yml          (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è)
docker/Dockerfile.web       (web –æ–±—Ä–∞–∑)
postgres.sh                 (—Å–∫—Ä–∏–ø—Ç –¥–ª—è Docker PostgreSQL)
```

## –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ –º–µ—Å—Ç–∞

**–í—Å–µ–≥–æ:** ~437 MB
- –ü–∞–∫–µ—Ç—ã Docker: 436 MB
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: 409 KB
- –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞: ~2 KB

**–ë—ã–ª–æ:** 6.4G —Å–≤–æ–±–æ–¥–Ω–æ  
**–°—Ç–∞–ª–æ:** 6.8G —Å–≤–æ–±–æ–¥–Ω–æ (+400MB)

## –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å

‚úÖ **PostgreSQL 18.0** - —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å
```bash
systemctl status postgresql
psql -U mikrokredit_user -d mikrokredit -h localhost
```

‚úÖ **Nginx 1.28.0** - —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å
```bash
systemctl status nginx
```

‚úÖ **Redis 7.4.1** - —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å
```bash
systemctl status redis-server
```

‚úÖ **MikroKredit** - Python virtualenv + Gunicorn
```bash
./start_service.sh
./stop_service.sh
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–¥–∞–ª–µ–Ω–∏—è

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –ù–µ—Ç overhead –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏
   - –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º
   - –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–ø—É—Å–∫ –∏ —Ä–∞–±–æ—Ç–∞

2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞**
   - –ú–µ–Ω—å—à–µ —Å–ª–æ—ë–≤ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
   - –ü—Ä–æ—â–µ –æ—Ç–ª–∞–¥–∫–∞
   - –ü–æ–Ω—è—Ç–Ω–µ–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

3. **–†–µ—Å—É—Ä—Å—ã**
   - –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ 437 MB –¥–∏—Å–∫–∞
   - –ú–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM
   - –ù–µ—Ç —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Docker

4. **–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ**
   - –ú–µ–Ω—å—à–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - –ü—Ä–æ—â–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞–ø—Ä—è–º—É—é

## –ö–æ–≥–¥–∞ Docker –Ω—É–∂–µ–Ω

Docker –ø–æ–ª–µ–∑–µ–Ω –∫–æ–≥–¥–∞:
- –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ù—É–∂–Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- Deployment –≤ –æ–±–ª–∞–∫–æ (Kubernetes, etc)
- CI/CD –ø–∞–π–ø–ª–∞–π–Ω—ã

## –ù–∞—à —Å–ª—É—á–∞–π

–£ –Ω–∞—Å:
- ‚úÖ –û–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ –û–¥–∏–Ω –ø—Ä–æ–µ–∫—Ç
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞
- ‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ

**–í—ã–≤–æ–¥:** Docker –∏–∑–±—ã—Ç–æ—á–µ–Ω! ‚ú®

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã (–µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∏–∑–æ–ª—è—Ü–∏—è)

### Python virtualenv (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
```bash
python -m venv .venv
source .venv/bin/activate
```
–ò–∑–æ–ª–∏—Ä—É–µ—Ç Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤.

### systemd-nspawn
–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∏–∑–æ–ª—è—Ü–∏—è –±–µ–∑ Docker - –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç systemd.

### –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞
–î–ª—è –ø–æ–ª–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ - –Ω–æ —ç—Ç–æ overkill –¥–ª—è –Ω–∞—à–µ–≥–æ —Å–ª—É—á–∞—è.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è

‚úÖ MikroKredit –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
curl http://localhost/healthz
# {"status":"ok"}
```

‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
```bash
psql -U mikrokredit_user -d mikrokredit -h localhost -c "SELECT COUNT(*) FROM loans;"
# 26 –∑–∞–ø–∏—Å–µ–π
```

‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
curl -I http://localhost/
# HTTP/1.1 200 OK
```

‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∞–∫—Ç–∏–≤–Ω—ã
```bash
systemctl status postgresql nginx redis-server
# All: active (running)
```

## –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Ubuntu 24.04 LTS                ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã                ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ PostgreSQL 18.0   (port 5432) ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ Nginx 1.28.0      (port 80)   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ Redis 7.4.1       (port 6379) ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  MikroKredit                      ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ Python 3.12 (virtualenv)     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ Gunicorn (port 8002)         ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ              ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  Nginx ‚îÄ‚îÄproxy‚îÄ‚îÄ> Gunicorn ‚îÄ‚îÄ> PostgreSQL
‚îÇ                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–í—Å—ë –ø—Ä–æ—Å—Ç–æ, –ø–æ–Ω—è—Ç–Ω–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ! üéØ

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏

### PostgreSQL
```bash
# –°—Ç–∞—Ç—É—Å
systemctl status postgresql

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo systemctl restart postgresql

# –ë—ç–∫–∞–ø
pg_dump -U mikrokredit_user -h localhost mikrokredit > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
psql -U mikrokredit_user -h localhost mikrokredit < backup.sql
```

### MikroKredit
```bash
# –ó–∞–ø—É—Å–∫
./start_service.sh

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
./stop_service.sh

# –õ–æ–≥–∏
tail -f logs/error.log
tail -f logs/access.log
```

### Nginx
```bash
# –°—Ç–∞—Ç—É—Å
systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo systemctl reload nginx
```

---
**–î–∞—Ç–∞:** 09.10.2025 09:00 MSK  
**–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ:** 437 MB  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Docker

